"0","# extract the residuals from the lm object and put it into our clustering data tibble"
"0","clustering_data$linear_model_residuals <- residuals(linear_model)"
"0",""
"0","# Compute Global Moran's I for linear model residuals; same weights as defined earlier "
"0","gmi_residuals <- moran.test(clustering_data$linear_model_residuals, weights)"
"0",""
"0","# Compute Local Moran's I for linear model residuals"
"0","lisa_residuals <- localmoran(clustering_data$linear_model_residuals, weights)"
"0","summary(lisa_residuals)"
"1",""
"1","       Ii          "
"1","      E.Ii           "
"1","     Var.Ii       "
"1","
"
"1"," Min.   :-4.20090  "
"1"," Min.   :-7.520e-03  "
"1"," Min.   :0.00000  "
"1","
"
"1"," 1st Qu.: 0.03434  "
"1"," 1st Qu.:-3.892e-04  "
"1"," 1st Qu.:0.01991  "
"1","
"
"1"," Median : 0.30546  "
"1"," Median :-1.420e-04  "
"1"," Median :0.08489  "
"1","
"
"1"," Mean   : 0.62460  "
"1"," Mean   :-2.976e-04  "
"1"," Mean   :0.18644  "
"1","
"
"1"," 3rd Qu.: 0.91098  "
"1"," 3rd Qu.:-3.546e-05  "
"1"," 3rd Qu.:0.23562  "
"1","
"
"1"," Max.   : 9.17451  "
"1"," Max.   : 0.000e+00  "
"1"," Max.   :4.59084  "
"1","
"
"1",""
"1","      Z.Ii        "
"1"," Pr(z != E(Ii))   "
"1","
"
"1"," Min.   :-6.1860  "
"1"," Min.   :0.00000  "
"1","
"
"1"," 1st Qu.: 0.3236  "
"1"," 1st Qu.:0.02502  "
"1","
"
"1"," Median : 1.2766  "
"1"," Median :0.16233  "
"1","
"
"1"," Mean   : 1.2738  "
"1"," Mean   :0.28558  "
"1","
"
"1"," 3rd Qu.: 2.2061  "
"1"," 3rd Qu.:0.49279  "
"1","
"
"1"," Max.   : 7.0137  "
"1"," Max.   :0.99983  "
"1","
"
"0","# significance as defined above; "
"0","clustering_data$clusters_residuals <- attributes(lisa_residuals)$quadr$mean"
"0","clustering_data$clusters_residuals[lisa[ ,5] > significance] <- ""Insignificant"""
"2","Warning in `[<-.factor`(`*tmp*`, lisa[, 5] > significance, value = ""Insignificant"") :"
"2","
 "
"2"," invalid factor level, NA generated
"
"0","# clustering of linear model residuals"
"0","tm_shape(clustering_data) + tm_polygons(""clusters_residuals"", fill.scale = tm_scale_categorical(values = c(""blue"", ""lightblue"", ""coral"", ""red"",""grey"")), col_alpha=0, tm_legend(title=""Clusters"", na.show = FALSE, frame=FALSE, title.size=1.2, text.size=1)) + tm_borders(lwd=0.1) +  tm_layout(frame=FALSE) + tm_title(text = """")"
