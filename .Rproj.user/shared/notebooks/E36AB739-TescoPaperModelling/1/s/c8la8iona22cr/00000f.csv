"0","# weights defined above"
"0","# significance defined above"
"0",""
"0","# First we need to extract the residuals from the lm object and put it into our clustering data tibble"
"0","clustering_data$bw_model_residuals <- residuals(bw_model)"
"0",""
"0","# Compute GMI"
"0","gmi_residuals <- moran.test(clustering_data$bw_model_residuals, weights)"
"0",""
"0","# LISA cluster instead?"
"0","# Compute Local Moran's I"
"0","lisa_residuals <- localmoran(clustering_data$bw_model_residuals, weights)"
"0","summary(lisa_residuals)"
"1",""
"1","       Ii          "
"1","      E.Ii           "
"1","     Var.Ii       "
"1","
"
"1"," Min.   :-4.20090  "
"1"," Min.   :-7.520e-03  "
"1"," Min.   :0.00000  "
"1","
"
"1"," 1st Qu.: 0.03434  "
"1"," 1st Qu.:-3.892e-04  "
"1"," 1st Qu.:0.01991  "
"1","
"
"1"," Median : 0.30546  "
"1"," Median :-1.420e-04  "
"1"," Median :0.08489  "
"1","
"
"1"," Mean   : 0.62460  "
"1"," Mean   :-2.976e-04  "
"1"," Mean   :0.18644  "
"1","
"
"1"," 3rd Qu.: 0.91098  "
"1"," 3rd Qu.:-3.546e-05  "
"1"," 3rd Qu.:0.23562  "
"1","
"
"1"," Max.   : 9.17451  "
"1"," Max.   : 0.000e+00  "
"1"," Max.   :4.59084  "
"1","
"
"1",""
"1","      Z.Ii        "
"1"," Pr(z != E(Ii))   "
"1","
"
"1"," Min.   :-6.1860  "
"1"," Min.   :0.00000  "
"1","
"
"1"," 1st Qu.: 0.3236  "
"1"," 1st Qu.:0.02502  "
"1","
"
"1"," Median : 1.2766  "
"1"," Median :0.16233  "
"1","
"
"1"," Mean   : 1.2738  "
"1"," Mean   :0.28558  "
"1","
"
"1"," 3rd Qu.: 2.2061  "
"1"," 3rd Qu.:0.49279  "
"1","
"
"1"," Max.   : 7.0137  "
"1"," Max.   :0.99983  "
"1","
"
"0","# LISA clusters according to significance (p>0.05 not significant) "
"0","significance <- 0.05"
"0","clustering_data$clusters_residuals <- attributes(lisa_residuals)$quadr$mean"
"0","clustering_data$clusters_residuals[lisa[ ,5] > significance] <- ""Insignificant"""
"0",""
"0","#Map of LISA clusters"
"0","# tm_shape(clustering_data)+tm_fill(""clusters_residuals"", palette=c(""blue"", ""coral"", ""lightblue"", ""red""),title=""Cluster"") + tm_layout(frame=FALSE) + tm_title(""Local Indicator of Spatial Autocorrelation (LISA) Clusters for LM residuals"")"
"0",""
"0",""
"0",""
"0","# How can we exclude the areas that weren't already LISA clustered for PC1? "
"0","#subset_df <- df[!(is.na(df$value) & df$condition), ]"
"0",""
"0","#make a new column incase we fuck it up"
"0","clustering_data$clusters_residuals_final <- clustering_data$clusters_residuals"
"0",""
"0","#if it wasn't a significant LISA already, it can't be a significant LISA residual"
"0","clustering_data$clusters_residuals_final[is.na(clustering_data$clusters)] <- NA"
"0",""
"0","tm_shape(clustering_data)+tm_fill(""clusters_residuals_final"", palette=c(""blue"", ""coral"", ""lightblue"", ""red""),title=""Cluster"") + tm_layout(frame=FALSE) + tm_title(""Local Indicator of Spatial Autocorrelation (LISA) Clusters for LM residuals"") "
"2","Deprecated tmap v3 code detected. Code translated to v4
"
